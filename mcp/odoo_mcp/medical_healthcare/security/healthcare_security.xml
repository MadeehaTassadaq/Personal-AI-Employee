<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data noupdate="1">

        <!-- Healthcare Manager Group -->
        <record id="group_healthcare_manager" model="res.groups">
            <field name="name">Healthcare Manager</field>
            <field name="category_id" ref="base.module_category_healthcare"/>
            <field name="implied_ids" eval="[(4, ref('base.group_user'))]"/>
            <field name="comment">Full access to healthcare features including patient management, appointments, and billing.</field>
        </record>

        <!-- Doctor Group -->
        <record id="group_doctor" model="res.groups">
            <field name="name">Doctor</field>
            <field name="category_id" ref="base.module_category_healthcare"/>
            <field name="implied_ids" eval="[(4, ref('base.group_user'))]"/>
            <field name="comment">Doctors can manage appointments and record patient visits.</field>
        </record>

        <!-- Nurse Group -->
        <record id="group_nurse" model="res.groups">
            <field name="name">Nurse</field>
            <field name="category_id" ref="base.module_category_healthcare"/>
            <field name="implied_ids" eval="[(4, ref('base.group_user'))]"/>
            <field name="comment">Nurses can record vitals and view patient information.</field>
        </record>

        <!-- Receptionist Group -->
        <record id="group_receptionist" model="res.groups">
            <field name="name">Receptionist</field>
            <field name="category_id" ref="base.module_category_healthcare"/>
            <field name="implied_ids" eval="[(4, ref('base.group_user'))]"/>
            <field name="comment">Receptionists can schedule appointments and manage patient registration.</field>
        </record>

        <!-- Patient Data Access Rules -->

        <!-- Manager can see all patients -->
        <record id="res_partner_healthcare_manager_rule" model="ir.rule">
            <field name="name">Healthcare Manager - All Patients</field>
            <field name="model_id" ref="base.model_res_partner"/>
            <field name="domain_force">[('is_patient', '=', True)]</field>
            <field name="groups" eval="[(4, ref('medical_healthcare.group_healthcare_manager'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="True"/>
        </record>

        <!-- Doctor can see all patients -->
        <record id="res_partner_doctor_rule" model="ir.rule">
            <field name="name">Doctor - All Patients</field>
            <field name="model_id" ref="base.model_res_partner"/>
            <field name="domain_force">[('is_patient', '=', True)]</field>
            <field name="groups" eval="[(4, ref('medical_healthcare.group_doctor'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
        </record>

        <!-- Nurse can view patients -->
        <record id="res_partner_nurse_rule" model="ir.rule">
            <field name="name">Nurse - View Patients</field>
            <field name="model_id" ref="base.model_res_partner"/>
            <field name="domain_force">[('is_patient', '=', True)]</field>
            <field name="groups" eval="[(4, ref('medical_healthcare.group_nurse'))]"/>
            <field name="perm_read" eval="True"/>
        </record>

        <!-- Receptionist can view and create patients -->
        <record id="res_partner_receptionist_rule" model="ir.rule">
            <field name="name">Receptionist - Patient Registration</field>
            <field name="model_id" ref="base.model_res_partner"/>
            <field name="domain_force">[('is_patient', '=', True)]</field>
            <field name="groups" eval="[(4, ref('medical_healthcare.group_receptionist'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
        </record>

        <!-- Appointment Access Rules -->

        <!-- Manager full access to appointments -->
        <record id="medical_appointment_manager_rule" model="ir.rule">
            <field name="name">Healthcare Manager - All Appointments</field>
            <field name="model_id" ref="medical_healthcare.model_medical_appointment"/>
            <field name="groups" eval="[(4, ref('medical_healthcare.group_healthcare_manager'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="True"/>
        </record>

        <!-- Doctor can see all appointments -->
        <record id="medical_appointment_doctor_rule" model="ir.rule">
            <field name="name">Doctor - All Appointments</field>
            <field name="model_id" ref="medical_healthcare.model_medical_appointment"/>
            <field name="domain_force">[('doctor_id', '=', user.partner_id.id)]</field>
            <field name="groups" eval="[(4, ref('medical_healthcare.group_doctor'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
        </record>

        <!-- Vitals Access Rules -->

        <!-- Manager full access to vitals -->
        <record id="medical_vitals_manager_rule" model="ir.rule">
            <field name="name">Healthcare Manager - All Vitals</field>
            <field name="model_id" ref="medical_healthcare.model_medical_vitals"/>
            <field name="groups" eval="[(4, ref('medical_healthcare.group_healthcare_manager'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="True"/>
        </record>

        <!-- Nurse can record vitals -->
        <record id="medical_vitals_nurse_rule" model="ir.rule">
            <field name="name">Nurse - Record Vitals</field>
            <field name="model_id" ref="medical_healthcare.model_medical_vitals"/>
            <field name="groups" eval="[(4, ref('medical_healthcare.group_nurse'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
        </record>

    </data>
</odoo>
